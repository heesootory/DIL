# jenkins GitLab ì—°ë™ + WebHook




<br>
<br>
<br>


## ğŸŒˆ GitLab ì—°ë™.

> ê¸°ë³¸ì ìœ¼ë¡œ github ë°©ë²•ê³¼ ê±°ì˜ ì¼ì¹˜í•˜ê³ , ìš©ì–´ê°€ ì¡°ê¸ˆ ë‹¤ë¥¼ë¿ì´ë‹¤!

<br>
<br>

### ğŸ³ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜.

<br>


> GitLab í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜.

<br>
<br>
<br>


### ğŸ³ gitLabì—ì„œ "ë‚´ ê³„ì •"ì— ì ‘ì†ì„ í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” jenkins credential ë§Œë“¤ê¸°.

<br>

> github ë¡œ ì—°ë™ì‹œ í–ˆë˜ "username with password" ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•˜ë‹¤.

* personal Access Token ì„ ë¶€ì—¬ë°›ê¸°.
    - select scopes : apiì™€ readì— ê´€ë ¨ëœ ê²ƒë§Œ ëª¨ë‘ ì„ íƒí•´ì¤Œ.(ì˜ ì´í•´ ëª»í•¨. ê³µë¶€ í•„ìš”.)

<img 
    src = "../Image/jenkins/53.png"
    width = 600px
    height = 400px   
/>

* jenkins credentials ë“±ë¡.
    - kind : Username with password
    - Username : GitLabì—ì„œ ì‚¬ìš©í•˜ëŠ” usernameì„ ì‚¬ìš©í•œë‹¤.  
        - ì´ë©”ì¼ ì•ë¶€ë¶„âŒ.
            <img 
                src = "../Image/jenkins/55.png"
                width = 300px
                height = 100px   
            />
    - Password: ë°©ê¸ˆ ìƒì„±í•œ personal Access Token ì„ ì…ë ¥.
    - ID : pipelineì—ì„œ ì‹¤ì œë¡œ êµ¬ë³„í•˜ê¸°ìœ„í•´ ì‚¬ìš©í•  credentialsIDê°€ ë  Alias.

<img 
    src = "../Image/jenkins/54.png"
    width = 550px
    height = 350px   
/>



<br>
<br>
<br>

### ğŸ³ ì‹¤ì œ í”„ë¡œì íŠ¸ì™€ ì—°ê²°.

* jenkins ê´€ë¦¬ > Configure System(ì‹œìŠ¤í…œ í™˜ê²½ì„¤ì •) > Git Lab
    - Connection name : ì•„ë¬´ë§(item êµ¬ì„±ì—ì„œ ì„¤íƒí•˜ê²Œ ë¨.)
    - GitLab host URL : Git Labì˜ ê²½ìš°, ë¬´ì¡°ê±´ ê± https://gitlab.comìœ¼ë¡œ ì ìŒ.(ssafyì—ì„œëŠ” https://lab.ssafy.com/ì˜€ìŒ.....ã… )
    - Credentials : ê°œì¸ ë ˆí¬ì™€ ì—°ê²°í•  ìˆ˜ ìˆëŠ” í† í° ë“±ë¡í•˜ê¸°.

<img 
    src = "../Image/jenkins/56.png"
    width = 600px
    height = 400px   
/>

* credentials
    - kind : GitLab API token
    - API token : ë ˆí¬ì§€í† ë¦¬ì˜ "Project access token".
    - ID : ì•„ë¬´ë§.

<img 
    src = "../Image/jenkins/57.png"
    width = 550px
    height = 250px   
/>


* Project access tokens
    - Token name : ì•„ë¬´ë§.
    - ë§Œë£Œë‚ ì§œ : ë„‰ë„‰íˆ
    - Select a role : Owner
    - Select scopes : ì´ë˜í•œ apiì™€ readê´€ë ¨ ëª¨ë‘ ì„ íƒ.

<img 
    src = "../Image/jenkins/58.png"
    width = 600px
    height = 400px   
/>


<br>
<br>
<br>
 
### ğŸ³ item pipeline script


* GitLab Connection
    - ë°”ë¡œ ì•ì—ì„œ ë“±ë¡í•œ ë ˆí¬ ê´€ë ¨ connectionì„ ì„ íƒ.

<img 
    src = "../Image/jenkins/59.png"
    width = 600px
    height = 400px   
/>


* pipeline script

    - credentialsId: ë‚´ ê³„ì •ì— ë“¤ì–´ê°ˆìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” token/key ë“±ë¡.
    - url : git cloneì‹œ ë”°ëŠ” https url.

```groovy
pipeline{
    agent any
    
    stages{
        stage('git clone'){
            steps{
                git credentialsId: 'gitlab_key', 
                branch: 'main',
                url: 'https://gitlab.com/heesootory/test'
            }
        }
    }
}
```


## ğŸŒˆ Web Hook

<br>
<br>


### ğŸ³ jenkins ì„¤ì •.

* item êµ¬ì„± > Build Triggers > build when a change is pushed GitLab.
    - ì²´í¬ì‹œ, ë‚˜ì˜¤ëŠ” url (1) ì•Œì•„ë‘ê¸°.
    - ê³ ê¸‰íƒ­ > ê°€ì¥ í•˜ë‹¨ì˜ tokenì„ ìƒì„±í•´ì„œ (2) ì•Œì•„ë‘ê¸°.

<img 
    src = "../Image/jenkins/60.png"
    width = 600px
    height = 400px   
/>
<img 
    src = "../Image/jenkins/61.png"
    width = 600px
    height = 400px   
/>


### ğŸ³ Git Lab ì„¤ì •.

* repo > settings > Webhooks
    - Url: ìœ„ì˜ (1)ì— í•´ë‹¹í•˜ëŠ” Url ê¸°ì¬.
    - Secret token : ìœ„ì˜ (2)ì— í•´ë‹¹í•˜ëŠ” token ê¸°ì¬. 

* merge request events ë¥¼ í‘œì‹œí•˜ë©´ ë‹¤ë¥¸ë¸Œëœì¹˜ì˜ mergeë„ ì¸ì‹í•˜ì—¬ webhookì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— -> ì²´í¬í•˜ì§€ ì•ŠëŠ”ë‹¤! ğŸˆ

<img 
    src = "../Image/jenkins/62.png"
    width = 500px
    height = 600px   
/>


<br>
<br>

# ì •ìƒë™ì‘! âœŒï¸

<img 
    src = "../Image/jenkins/63.png"
    width = 500px
    height = 600px   
/>
