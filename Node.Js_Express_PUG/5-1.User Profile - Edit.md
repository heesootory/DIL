# User Profile 


<br>

## index



<!-- TOC -->

- [User Profile](#user-profile)
  - [index](#index)
  - [Edit Profile1](#edit-profile1)
  - [Protector and Public Middlewares](#protector-and-public-middlewares)
    - [controller 에 middleware 추가로 보안 up!](#controller-에-middleware-추가로-보안-up)
  - [Edit Profile2](#edit-profile2)
    - [controller - DB 수정](#controller---db-수정)

<!-- /TOC -->



<br>



---


<br>


## Edit Profile1

* edit Controller & Router

![d](/Image/Express/e1.PNG)
![d](/Image/Express/e2.PNG)

* view - base

![d](/Image/Express/e3.PNG)


* view - edit-profile

![d](/Image/Express/e4.PNG)
![d](/Image/Express/e5.PNG)

> local에 저장된 정보는 view파일어디에서든 사용가능!!


* middleware

![d](/Image/Express/e7.PNG)

> 빈 객체도 local에 저장할 수 있게 해서, 비로그인시에 url로 들어갈 수 있게.
<br>
> 이걸 수정해야 하기 때문에 일단 들어가게 설정해본다.

![d](/Image/Express/e6.PNG)

> 로그인이 되있지 않은 상태에도, url로 들어갈 수 있는데, 수정해야할 부분!




## Protector and Public Middlewares 

> 비로그인자들이 edit페이지에 무단으로 url을 통해 들어오는 걸 막아보자.

![d](/Image/Express/e8.PNG)

* protectordMiddleware
> 로그인자만 접근 가능한 미들웨어. <br>
> 사용자가 로그인되어 있지 않다면, 홈으로 리다이렉트.

* publicOnlyMiddleware
> 비로그인자만 접근 가능한 미들웨어. 로그인 되어있다면, 홈으로 리다이렉트.

### controller 에 middleware 추가로 보안 up!

![d](/Image/Express/e9.PNG)
![d](/Image/Express/e10.PNG)

* all()
> 어떤 http method에도 적용시키는 함수.

>> 추후에 video model과 user model이 합쳐지는 상황이 오는데, 그때를 위해서, video controller에도 추가시켜주자.

![d](/Image/Express/e11.PNG)
![d](/Image/Express/e12.PNG)



## Edit Profile2

### controller - DB 수정



* req.query -> get 정보
* req.body -> post 정보
* req.session -> req.object(user = 우리가 집어 넣은 객체)

* ES6

```js
const {
        session: {
            user: {id},
        },
    } = req;
```
```js
const i = req.session.user.id;
```
> 위의 두 방식은 동일.

> 다른 변수들도 다른상황에서 쉽게 가져올 수 있기 때문에, 1번의 방식이 선호.

![d](/Image/Express/e13.PNG)

> req.에서 필요한 변수를 두문장으로 따로 가져오는걸(주석된 문장) -> 쉽게 가져올 수 있다.



























































