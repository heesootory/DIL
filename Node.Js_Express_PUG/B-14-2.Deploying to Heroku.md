# Deploying to Heroku


<br>

## index


<br>

---

<br>




## Heroku

> ì„œë²„ë¥¼ ì•„ì£¼ ë¹ ë¥´ê²Œ ë°°í¬í•  ìˆ˜ ìˆëŠ” ì›¹ì‚¬ì´íŠ¸.

[https://www.heroku.com/home](https://www.heroku.com/home)



### Heroku CLI ì´ìš©

![api](/Image/Express/k13-1.png)

* Heroku CLI ì„¤ì¹˜ 

```zsh
$ brew tap heroku/brew && brew install heroku
```

* ë¡œê·¸ì¸

```zsh
$ heroku login
```

![api](/Image/Express/k14.png)

> heroku ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë¡œê·¸ì¸.

![api](/Image/Express/k15.png)

```zsh
$ heroku init
$ heroku git:remote -a [ì•±ëª…]
```

> heroku remoteë¥¼ ìƒì„±.

> ì´ì œ gitì—ì„œ add.commit ë“±ë“±ì„ í•˜ê³  pushë¥¼ Herokuì— í•  ìˆ˜ ìˆê²Œë¨.

* ì´ì œë¶€í„° HerokuëŠ” gitì„ ê¸°ë°˜ìœ¼ë¡œ ìš°ë¦¬ ì½”ë“œì˜ historyë¥¼ ì§€ì¼œë³´ëŠ”ë°, ìš°ë¦¬ê°€ commitì„ í•˜ì§€ì•Šìœ¼ë©´, herokuê°€ ì•Œ ìˆ˜ ì—†ìŒ! 
    - ìš°ë¦¬ê°€ ì½”ë“œë¥¼ ë³€ê²½í•˜ë©´ ë¬´ì¡°ê±´ commitì„ í•´ì•¼í•¨!
    - gitignoreì— ì ì–´ë‘” ì‚¬í•­ë“¤ì€ Herokuì— ì—…ë¡œë“œê°€ ë˜ì§€ì•ŠìŒ.


* ë°°í¬

```zsh
$ git push heroku main/master
```
> ìì‹ ì˜ ë¸Œëœì¹˜ ì´ë¦„ì´ mainì´ëƒ, masterì´ëƒì— ë”°ë¼.

![api](/Image/Express/k16.png)

* command ê°€ serverë‚˜ Herokuì˜ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆê²Œ ì„¤ì •.

```zsh
$ heroku logs --tail
```

![api](/Image/Express/k17.png)

* heroku ê°€ ë§¨ì²˜ìŒ buildëª…ë ¹ì–´ë¡œ buildë¥¼ ì‹¤í–‰.

* heroku ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ npm startë¡œ ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— ìë™ìœ¼ë¡œ npm ì‹œì‘.

â„ï¸ init.jsë¥¼ ì°¾ì§€ëª»í•˜ëŠ” ì—ëŸ¬ ë°œìƒ.

```zsh
$ git add .
$ git commit -m "build script"
$ git push origin main && git push heroku main
```

> add . ì™€ commit ê¼­ í•´ì£¼ê¸°.

â„ï¸ mongoDB_URL ì—ëŸ¬ -> .env íŒŒì¼ì— ìˆëŠ” ì†ì„±ì´ .envê°€ gitignoreë˜ì—ˆê¸° ë•Œë¬¸ì— ì¡´ì¬ í•˜ì§€ ì•ŠëŠ” ì—ëŸ¬.

> herokuëŠ” gitê¸°ë°˜ì˜ historyë¥¼ ì½ê³  buildë¥¼ í•˜ëŠ”ë°, .envê°€ ì—†ë‹¤.

> í•˜ì§€ë§Œ, .envëŠ” ì–´ë–¤ ê²½ìš°ì—ë„ gitì— ì˜¬ë¦¬ë©´ ì•ˆë˜ëŠ” ê°’ë“¤ì´ë‹¤.

![api](/Image/Express/k18.png)

> gitignoreì˜ í´ë”ê°€ í•„ìš”í• ì‹œ ì—ëŸ¬í•´ê²°.ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡

### MongoDB Atlas

![api](/Image/Express/k19.png)

> project ìƒì„± -> cluster ì¶”ê°€. -> ì „ë¶€ freeë¡œ ì„ íƒ -> awsì´ìš©  -> êµ­ê°€ : ëŒ€í•œë¯¼êµ­

* cluster : database group

![api](/Image/Express/k20.png)
![api](/Image/Express/k21.png)

> ì¡°ê¸ˆ ê¸°ë‹¤ë¦¬ë©´, cluster ìƒì„±!

> connect -> ipëŠ” ëª¨ë‘ ë‹¤ ì ‘ê·¼ ê°€ëŠ¥í•œê±° ì„ íƒ 

![api](/Image/Express/k22.png)

> ì´ì œ DBë¥¼ ê´€ë¦¬í•  ì•„ì´ë””ì™€ ë¹„ë²ˆì„ ë§Œë“œëŠ”ë°, DBë³´ì•ˆì´ ë§¤ìš° ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì—, ë¹„ë°€ë²ˆí˜¸ëŠ” ìë™ìƒì„±ìœ¼ë¡œ ì–´ë µê²Œ ë§Œë“ ê±¸ë¡œ í•˜ê³ , ì•ˆì „í•œê³³ì— ì ì–´ë‘”ë‹¤.

![api](/Image/Express/k23.png)

> ìš°ë¦¬ ì•±ê³¼ ì—°ê²°í•  ê²ƒì´ë¯€ë¡œ.

![api](/Image/Express/k25.png)

> ì´ DBì˜ URLì´ .envíŒŒì¼ì— ìˆëŠ” DB_URLê³¼ ê°™ì€ ê²ƒì´ë‹¤.

![api](/Image/Express/k24.png)

> ê¸°ì¡´ì˜ .envì— ìˆëŠ” ì´ urlì€ localhostì— ì €ì¥í•˜ê¸° ìœ„í•œ ì£¼ì†Œ ì˜€ë‹¤.

> ì´ì   mongoDB ì„œë²„ì— ìˆëŠ” ì§„ì§œ DBì£¼ì†Œë¥¼ ì–»ì—ˆê³ , herokuê°€ ì´ ì£¼ì†Œë¥¼ ì—°ê²°ì‹œì¼œ ì¤„ ê²ƒì´ë‹¤.

> ì´ì œ Herokuì˜ admin panelì„ ì‚¬ìš©í•´ì„œ ì´ DB_URLì„ ì„¤ì •.

* Herokuì˜ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë”°ë¡œ ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤!! 

![api](/Image/Express/k26.png)

> heroku my app -> settings -> reveal config vars

* key : DB_URL
* value : mongodb+srv://heesootory:<password>@cluster0.d4kgt.mongodb.net/?retryWrites=true&w=majority

(CBfjlKUXM1QJpnTs)

> gitignoreì— ìˆë˜ COOKIE_SECRET, GH_CLIENT, GH_SECRET ë³€ìˆ˜ë„ ë„£ì–´ì£¼ì.

![api](/Image/Express/k27.png)

![api](/Image/Express/k28.png)

â„ï¸ ë³€ìˆ˜ê°€ ëª¨ë‘ ì •ìƒì ìœ¼ë¡œ ì €ì¥ëœê²ƒì€ í™•ì¸ë˜ëŠ”ë°, ì‚¬ì´íŠ¸ëŠ” ì—´ë¦¬ì§€ ì•Šê³ , ë˜ ë‹¤ë¥¸ ì—ëŸ¬ë©”ì„¸ì§€!!
-> ìš°ë¦¬ê°€ í¬íŠ¸ë¥¼ ì—°ê²°í•˜ì§€ ì•Šì•˜ë‹¤!

* ìš°ë¦¬ëŠ” ìš°ë¦¬ì•±ì˜ í¬íŠ¸ë¥¼ 4000ë²ˆìœ¼ë¡œ ì§€ì •í•´ì„œ ì—´ì–´ë†¨ëŠ”ë°, í¬íŠ¸ 4000ì€ herokuê°€ ìš°ë¦¬ì—ê²Œ ì¤€ í¬íŠ¸ë²ˆí˜¸ê°€ ì•„ë‹ˆë‹¤.

* ëŒ€ë¶€ë¶„ì˜ ê²½ìš° herokuëŠ” ëœë¤ í¬íŠ¸ ë„˜ë²„ë¥¼ ìš°ë¦¬ì—ê²Œ ì¤€ë‹¤.

![api](/Image/Express/k29.png)

> ì—ëŸ¬ë¥¼ ë³´ë©´, herokuê°€ ìš°ë¦¬ì—ê²Œ í¬íŠ¸ë³€ìˆ˜ë¥¼ ì „ë‹¬í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê·¸ ë³€ìˆ˜ë¡œ ì§€ì •í•´ì£¼ì.

![api](/Image/Express/k30.png)

> localì—ì„œ ì‹¤í–‰í• ë–„ëŠ” í¬íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ 4000ë²ˆ, í—¤ë¡œì¿ ê°€ ì „ë‹¬í• ë•ŒëŠ”, ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê²Œ ì„¤ì •.

ğŸ”¥ ì½”ë“œ ë³€ê²½ì´ ìˆì—ˆìœ¼ë¯€ë¡œ, 
ğŸ”¥ 
```zsh
$ git add .
$ git commit -m "build script"
$ git push heroku main
```
ğŸ”¥ 
ğŸ”¥ í•„ìˆ˜~~~!!!!

![api](/Image/Express/k31.png)

> build ì™„ë£Œí›„, logë¥¼ ë³´ë©´ í—¤ë¡œì¿ ê°€ ìƒˆë¡œìš´ í¬íŠ¸ë²ˆí˜¸ë¥¼ ì¤€ ê±¸ í™•ì¸í•  ìˆ˜ ìˆê³ , 

![api](/Image/Express/k32.png)

> ë°°í¬ ì•±ì´ ì˜ ì—´ë¦¬ëŠ” ê²ƒ í™•ì¸!!

#### github ë¡œê·¸ì¸ ì—ëŸ¬

![api](/Image/Express/k33.png)

* github settingì—ì„œ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤.

> github -> settings -> Developer settings -> OAuth Apps -> my project

* Authorization callback URL ìˆ˜ì •ì´ í•„ìš”.

![api](/Image/Express/k34.png)
![api](/Image/Express/k35.png)

> í˜„ì¬ loaclhostë¡œ ë˜ì–´ìˆëŠ” ì¸ì¦ urlì„ heroku ë°°í¬ ì‚¬ì´íŠ¸ë¡œ ë³€ê²½!

> ì´ê±¸ ë³€ê²½í•˜ë©´, ì¡°ê¸ˆ ê·€ì°®ì€ ì ì´ localí™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•  ë• ë‹¤ì‹œ localë¡œ ë³€ê²½ì„ í•´ì¤˜ì•¼ í•œë‹¤.
ğŸ”¥  ê·¸ë˜ì„œ ì•±ì„ 2ê°œ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•¨.
1. ê³µì‹ì•± - heroku urlì‚¬ìš© / Client ID, Client Secret ì„ herokuì— ë‘ë©´ë¨.
2. í…ŒìŠ¤íŠ¸ì•± - local url ì‚¬ìš© / Client ID, Client Secret ì„ .envì— ë‘ê³  ì‚¬ìš©.

<br>
<br>
<br>

### git hub ì´ìš©

![api](/Image/Express/k36.png)

![api](/Image/Express/k37.png)

> ê¹ƒí—™ì— ì˜¬ë¦° ë‚´ í”„ë¡œì íŠ¸ ë ˆí¬ë¥¼ ì°¾ê³  connect!


![api](/Image/Express/k38.png)

> ì—°ê²°ì´ ë˜ë©´ ì´ì œ, push git origin main í• ë•Œë§ˆë‹¤, ë°”ë¡œ ë°°í¬ê°€ ê°€ëŠ¥!

> githubë¡œ ì—…ë°ì´íŠ¸ë¥¼ í• ë•Œë§ˆë‹¤, í—¤ë¡œì¿ ëŠ” ê·¸ê±´ ê´€ì°°í•˜ê³  ë°°í¬ë¥¼ ë„ì™€ì¤Œ.

![api](/Image/Express/k39.png)

ğŸ”¥ ì£¼ì˜í• ì  !!! ì´ì œ gitì— ì˜¬ë¦´ë•Œë§ˆë‹¤ ë°°í¬ê°€ ë¨ìœ¼ë¡œ, ì´ ë¸Œëœì¹˜ëŠ” í•­ìƒ ë°°í¬ê°€ ê°€ëŠ¥í•œ ë²„ì ¼ì´ì–´ì•¼ í•œë‹¤. ì˜ëª»ëœ ë²„ì ¼ì„ ì˜¬ë¦¬ê²Œ ë˜ë©´ ì—ëŸ¬ê°€ ë‚ ê²ƒ!
ê¼­ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê³  ê¹ƒì— ì˜¬ë ¤ì•¼í•œë‹¤.

â„ï¸ ë¬¸ì œëŠ” ìš°ë¦¬ê°€ ì•„ë°”íƒ€ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì˜ìƒì„ ì—…ë¡œë“œí•˜ê³ , ë‹¤ë¥¸ ìˆ˜ì •ì‘ì—…ì„ í•œ í›„ ë°°í¬ë¥¼ ì§„í–‰í•˜ë©´, ì´ì „ì˜ íŒŒì¼ì€ ëª¨ë‘ ì‚­ì œë˜ë¯€ë¡œ, ì‚¬ì§„ì´ë‚˜ ì˜ìƒì„ ë³¼ ìˆ˜ ì—†ê²Œ ëœë‹¤.

ğŸ”¥ header fix
![api](/Image/Express/k40.png)

> avatarUrl ì— githubê°€ í¬í•¨ë˜ìˆì„ì‹œ, githubì‚¬ì§„ì„ ê°€ì ¸ì˜¤ê³ , ì•„ë‹ˆë¼ë©´ ì˜¬ë¦° íŒŒì¼ì„ ë³´ì—¬ì£¼ê¸°.













































