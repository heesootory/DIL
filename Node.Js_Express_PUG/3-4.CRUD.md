# CRUD

<br>



<!-- TOC -->

- [CRUD](#crud)
  - [Upload video](#upload-video)
    - [Uploadë¥¼ ìœ„í•œ viewíŒŒì¼ ìˆ˜ì •](#uploadë¥¼-ìœ„í•œ-viewíŒŒì¼-ìˆ˜ì •)
    - [Uploadë¥¼ ìœ„í•œ controller ìˆ˜ì •](#uploadë¥¼-ìœ„í•œ-controller-ìˆ˜ì •)
    - [video ë°›ì•„ì˜¤ê¸°](#video-ë°›ì•„ì˜¤ê¸°)
      - [1. document ìƒì„±. (document = ë°ì´í„°ë¥¼ ê°€ì§„ ë¹„ë””ì˜¤)](#1-document-ìƒì„±-document--ë°ì´í„°ë¥¼-ê°€ì§„-ë¹„ë””ì˜¤)
      - [2. documentë¥¼ databaseì— ì €ì¥.](#2-documentë¥¼-databaseì—-ì €ì¥)
    - [create í•¨ìˆ˜ & error ë°œìƒ](#create-í•¨ìˆ˜--error-ë°œìƒ)
    - [more about schema](#more-about-schema)
      - [cf. mixins ìˆ˜ì •](#cf-mixins-ìˆ˜ì •)
  - [Video Detail](#video-detail)
    - [regular expression(ì •ê·œí‘œí˜„ì‹)ì„ ì´ìš©í•´ì„œ routerí•´ê²°!](#regular-expressionì •ê·œí‘œí˜„ì‹ì„-ì´ìš©í•´ì„œ-routerí•´ê²°)
      - [templateê³¼ controller ìˆ˜ì •](#templateê³¼-controller-ìˆ˜ì •)
    - [ì¡´ì¬í•˜ì§€ ì•ŠëŠ” idë¡œ ì ‘ì†í• ë•Œ ì²˜ë¦¬](#ì¡´ì¬í•˜ì§€-ì•ŠëŠ”-idë¡œ-ì ‘ì†í• ë•Œ-ì²˜ë¦¬)
  - [Edit Video](#edit-video)
    - [get contorller ìˆ˜ì •](#get-contorller-ìˆ˜ì •)
      - [hashtags ìˆ˜ì •.](#hashtags-ìˆ˜ì •)
    - [Post controller ìˆ˜ì •](#post-controller-ìˆ˜ì •)
      - [findOne query ì´ìš©í•˜ê¸°!!](#findone-query-ì´ìš©í•˜ê¸°)
  - [mongoose middleware (= hook)](#mongoose-middleware--hook)
  - [ì¼ë°˜ js í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ, ë¶„ë¦¬í•˜ê¸°.](#ì¼ë°˜-js-í•¨ìˆ˜ë¥¼-ì´ìš©í•´ì„œ-ë¶„ë¦¬í•˜ê¸°)
  - [Staticìœ¼ë¡œ ì •ë¦¬.](#staticìœ¼ë¡œ-ì •ë¦¬)
      - [cf. í•´ì‹œíƒœê·¸ templateì— ë³´ì´ê²Œ](#cf-í•´ì‹œíƒœê·¸-templateì—-ë³´ì´ê²Œ)
  - [Delete Video](#delete-video)

<!-- /TOC -->


---

<br>



## Upload video

![d](/Image/Express/i18.PNG)

> createdAt, metaì •ë³´ëŠ” clientì—ê²Œ ìë™ìœ¼ë¡œ ì œê³µì´ ë˜ëŠ” ì •ë³´ì´ë‹¤.

> ìš°ë¦¬ëŠ” ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ì— ëŒ€í•´ì„œë§Œ ê¸°ì…í•˜ê³  ë°ì´í„°ë¥¼ ì €ì¥ì‹œí‚¤ë©´ ëœë‹¤.


### Uploadë¥¼ ìœ„í•œ viewíŒŒì¼ ìˆ˜ì •

![d](/Image/Express/i19.PNG)
> actionì€ ì´í˜ì´ì§€ë¥¼ ë§í•˜ê¸° ë–„ë¬¸ì—, ì‚­ì œí•´ë„ ë¬´ë°©.
> input ì—ëŠ” í•­ìƒ nameì´ í•„ìš”!!!


### Uploadë¥¼ ìœ„í•œ controller ìˆ˜ì •

![d](/Image/Express/i20.PNG)

> input ì—ì„œ ì •ì˜í•œ nameì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë“¤ì„ ì¼ë‹¨ ë°›ì•„ì˜¤ì

### video ë°›ì•„ì˜¤ê¸°

#### 1. document ìƒì„±. (document = ë°ì´í„°ë¥¼ ê°€ì§„ ë¹„ë””ì˜¤)

![d](/Image/Express/i21.PNG)
> ES6 ë¬¸ë²•ì— ë”°ë¼, ê°„ëµíˆ title, descriptionê¸°ì….
(title: title, descrption: description ê³¼ ë™ì¼)

* hashtagsëŠ” ë°°ì—´ì´ë¯€ë¡œ, 

![d](/Image/Express/i22.PNG)
> ì´ëŸ° í˜•íƒœë¡œ ë§Œë“¤ì–´ ì¤„ ê²ƒ. (splitê³¼ map ì´ìš©)

![d](/Image/Express/i23.PNG)

> video objectì™„ì„±.

![d](/Image/Express/i24.PNG)
> consoleë¡œ ê°ì²´ í™•ì¸!

> ì•„ì§ DBë¡œ ë„˜ì–´ê°€ì§„ ì•Šì€ ìƒíƒœ, JSìƒì—ì„œë§Œ ì „ë‹¬í•´ ì£¼ê³  ìˆë‹¤.








<br>
<br>
<br>
<br>


#### 2. documentë¥¼ databaseì— ì €ì¥.

![d](/Image/Express/i25.PNG)

> saveí•¨ìˆ˜ë¡œ dbì— ì €ì¥ì‹œí‚¤ì.
> saveí•¨ìˆ˜ëŠ” promiseë¥¼ ë°˜í™˜í•˜ê³ , ì €ì¥í•˜ëŠ” ë™ì•ˆ ê¸°ë‹¤ë ¤ì¤„ ì‹œê°„ì´ í•„ìš”í•˜ë‹¤.


![d](/Image/Express/i26.PNG)

![d](/Image/Express/i27.PNG)

> dbì— ì €ì¥!! í™•ì¸!

![d](/Image/Express/i28.PNG)

> "home"page ì—ì„œë„ í™•ì¸!!

![d](/Image/Express/i29.PNG)

> Mongo DBì—ë„ ì €ì¥ëœê±¸ í™•ì¸!!

```bash
show collections
```
> collectionsëŠ” documentsë“¤ì˜ ë¬¶ìŒ.
> í˜„ì¬ëŠ” ìš°ë¦¬ëŠ” videosë¼ëŠ” document í•˜ë‚˜ë¿ì´ë¼ í•˜ë‚˜ë§Œ ëœ¸.

![d](/Image/Express/i30.PNG)

> ë°©ê¸ˆ ì €ì¥í•œ ë°ì´í„°ë„ í™•ì¸ ê°€ëŠ¥.



### create í•¨ìˆ˜ & error ë°œìƒ

![d](/Image/Express/i31.PNG)
> save í•¨ìˆ˜ ëŒ€ì‹ , createí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ, ì¢€ë” ê°„í¸í•˜ê²Œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

* validation error
1.
![d](/Image/Express/i32.PNG)

2.
![d](/Image/Express/i33.PNG)

> ì´ëŸ° ì—ëŸ¬ë“¤ì´ ë¹ˆë²ˆíˆ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë°, ë‹¤í–‰íˆ mongooseê°€ modelingí•œ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡ì•„ì£¼ê¸´í•œë‹¤.
> -> ë”°ë¼ì„œ, ë°ì´í„° modelingì„ í• ë•Œ(schemaë¥¼ ì‘ì„±ì‹œ) ìµœëŒ€í•œ ìì„¸í•˜ê²Œ ì ì–´ì£¼ëŠ” ê²Œ ì¢‹ë‹¤!!

ì´ëŸ° ì—ëŸ¬ê°€ ëœ°ë•Œ, ì„œë²„ê°€ ì—°ê²°ì„ ìƒì§€ì•Šê³ , ì§„í–‰ë˜ê²Œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì£¼ì.


![d](/Image/Express/i34.PNG)

> ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í†µí•´, ë‹¤ì‹œ ë¹ˆ í˜ì´ì§€ë¡œ ëŒì•„ì˜¤ê³ , errorë¥¼ ì¶œë ¥í•˜ì—¬, í™•ì¸í•  ìˆ˜ ìˆê²Œ ì§„í–‰.


![d](/Image/Express/i35.PNG)

> ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ templateìœ¼ë¡œ ë³´ë‚´, clientë“¤ ì—ê²Œë„ ë³´ì´ê²Œ ì§„í–‰.


![d](/Image/Express/i36.PNG)
> schema ì¢€ë” ê¹”ë”íˆ ì •ë¦¬.

* date.nowë¥¼ defaultë¡œ ì ì–´ì¤¬ëŠ”ë°, () -> í•¨ìˆ˜í‘œê¸°ë¥¼ í•˜ì§€ ì•Šì€ ì´ìœ ëŠ”,
mongooseê°€ ì•Œì•„ì„œ ê°ì²´ê°€ ìƒì„±ë  ë•Œ, í•¨ìˆ˜ë¡œ ì‘ë™ì‹œì¼œì¤Œ.


### more about schema

> schemaì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì§„ìˆ ì„ ë„ˆë¬´ë„ˆë¬´ ì¤‘ìš”!

* trim
> ì–‘ìª½ì˜ ë¹ˆê³µê°„ì„ ì—†ì• ì¤Œ.
![d](/Image/Express/i37.PNG)

* maxlength, minlength

![d](/Image/Express/i38.PNG)

> htmlì—ë„ ì ìš©ì‹œì¼œì£¼ë©´, htmlì—ì„œ ë¶€í„° ê¸€ììˆ˜ë¥¼ ì œí•œ í•´ì¤„ ìˆ˜ ìˆë‹¤!

â„ï¸ ê·¸ëŸ¬ë©´, htmlì—ì„œë§Œ ì œí•œí•˜ë©´ ë˜ì§€, ì™œ db schemaì—ë„ ëª…ì‹œë¥¼ í•´ì¤˜ì•¼í• ê¹Œ!?<br>

ğŸ”¥ í•´ì»¤ê°€ htmlíŒŒì¼ì„ ìˆ˜ì •ì‹œì¼œë²„ë ¤ì„œ, ì´ìƒí•œ ê°’ì´ ë“¤ì–´ì˜¤ê²Œ í•  ìˆ˜ë„ ìˆë‹¤!



#### cf. mixins ìˆ˜ì •

![d](/Image/Express/i39.PNG)

---

<br>
<br>
<br>

## Video Detail

![d](/Image/Express/c1.PNG)

![d](/Image/Express/c2.PNG)

> ë¬¸ì œ: í˜„ì¬ video.titleì„ ëˆŒë¦¬ë©´, í•´ë‹¹ idë¥¼ í†µí•´ urlë¡œ ë“¤ì–´ê°€ê²Œë˜ëŠ”ë°, routerì—ì„œ idë¥¼ ìˆ«ìë§Œ ë°›ê²Œ í•´ì„œ, í˜„ì¬ ì™„ì „ ëœë¤ìœ¼ë¡œ ë“¤ì–´ê°„ idë¥¼ ì°¾ì§€ ëª»í•˜ê³  ìˆë‹¤!!


### regular expression(ì •ê·œí‘œí˜„ì‹)ì„ ì´ìš©í•´ì„œ routerí•´ê²°!

![d](/Image/Express/c3.PNG)

> objectì˜ idëŠ” 24ë°”ì´íŠ¸ 16ì§„ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì •ì˜!

[ì •ê·œì‹ ê²€ì‚¬ - https://www.regextester.com/](https://www.regextester.com/)

![d](/Image/Express/c4.PNG)

> 16ì§„ìˆ˜ ì´ë¯€ë¡œ, 1,2,3,4,5,6,7,8,9,a,b,c,d,e,fë¥¼ ì‚¬ìš©í•˜ë‹ˆê¹Œ,
> ê·¸ì— í•´ë‹¹í•˜ëŠ” ë²”ìœ„ë¥¼ ë§ì¶°ì£¼ì!

![d](/Image/Express/c5.PNG)
> ì •ê·œì‹ í‘œí˜„ìœ¼ë¡œ ë„£ì–´ì£¼ê¸°

#### templateê³¼ controller ìˆ˜ì •

[mongoose query - https://mongoosejs.com/docs/queries.html](https://mongoosejs.com/docs/queries.html)


![d](/Image/Express/c6.PNG)
> routerì—ì„œ urlì„ í†µí•´ ë°›ì€ idê°’ì„ ì´ìš©í•´, queryë¬¸(findById)ìœ¼ë¡œ DBì—ì„œ í•´ë‹¹ videoë¥¼ ì°¾ê³ , ì¶œë ¥!
> ë¬¼ë¡ , DBì—ì„œ ì°¾ëŠ” ê³¼ì •ì€ awaitë¡œ ëŒ€ê¸°!


### ì¡´ì¬í•˜ì§€ ì•ŠëŠ” idë¡œ ì ‘ì†í• ë•Œ ì²˜ë¦¬

![d](/Image/Express/c7.PNG)
![d](/Image/Express/c8.PNG)

> ì¡´ì¬í•˜ì§€ ì•ŠëŠ” idë¡œ ì ‘ê·¼ì‹œ, 404í˜ì´ì§€ë¥¼ ì¶œë ¥í•˜ì.










---

<br>
<br>
<br>

## Edit Video



### get contorller ìˆ˜ì •
> ì—ëŸ¬ë¥¼ ë¨¼ì € ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ì„±í•´ë³´ì.

![d](/Image/Express/c9.PNG)

> ì´ë•Œ, ë°˜ë“¯ì´ ì—ëŸ¬ ì¶œë ¥ì—ë„ return ì„ í•´ì¤˜ì•¼ ë’¤ì— ì½”ë“œë“¤ì´ ì‹¤í–‰ë˜ì§€ ì•Šê³ , ì—ëŸ¬ ì •ìƒ ì¶œë ¥ì´ ë  ìˆ˜ ìˆë‹¤.


![d](/Image/Express/c10.PNG)
![d](/Image/Express/c11.PNG)

> ì—¬ëŸ¬ê°€ì§€ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ê²Œë”, ì „ë¶€ ë„˜ê²¨ì£¼ê¸°.

#### hashtags ìˆ˜ì •.

> ë°°ì—´ì˜ í˜•íƒœê°€ ì•„ë‹Œ stringì˜ í˜•íƒœë¡œ ë°”ê¿”ì£¼ì.

![d](/Image/Express/c12.PNG)

![d](/Image/Express/c13.PNG)


### Post controller ìˆ˜ì •

![d](/Image/Express/c14.PNG)

> ë§¤ìš° ì§ê´€ì ìœ¼ë¡œ updateí•˜ëŠ” ë°©ë²•, but ë°ì´í„° ì†ì„±ì´ ë§ì•„ì§„ë‹¤ë©´.... ë‹¤ ì¼ì¼íˆ ê³ ì¹˜ê¸° ë§¤ìš° ì–´ë µë‹¤.

![d](/Image/Express/c15.PNG)

> í•´ì‹œíƒœê·¸ê°€ ë¬´ì¡°ê±´ ë¶™ì§€ ì•Šë„ë¡, ë³€ê²½


#### findOne query ì´ìš©í•˜ê¸°!!

> ì–´ë–¤ queryë“ ì§€, findOneì´ ìˆëŠ”ê±°ë©´, ì¡°ê±´ì„ ì§‘ì–´ë„£ê³  ê·¸ ì¡°ê±´ì— í•´ë‹¹ë˜ëŠ” ë°ì´í„°ë§Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.


[findOneAndUpdate - https://mongoosejs.com/docs/api.html#model_Model.findOneAndUpdate](https://mongoosejs.com/docs/api.html#model_Model.findOneAndUpdate)


![d](/Image/Express/c16.PNG)

![d](/Image/Express/c17.PNG)
> findByIdAndUpdate()ë¥¼ ì‚¬ìš©í•´ë³´ì.

![d](/Image/Express/c18.PNG)
> ì£¼ì˜í• ì ì€ findByIdAndUpdateëŠ” Video(model)ì—ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ì´ë‹¤.
> 
> ìš°ë¦¬ê°€ ë§Œë“  const videoë‘ ë‹¤ë¥´ë‹¤.

![d](/Image/Express/c19.PNG)
> existëŠ” ()ì— ì›í•˜ëŠ” ì†ì„±ì„ ë„£ì–´, ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸ê°€ëŠ¥.

![d](/Image/Express/c20.PNG)

> getê³¼ ë‹¤ë¥´ê²Œ postì—ì„œëŠ” idë§Œ ì•Œê³  ê·¸ ê°ì²´ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ë§Œ í•˜ë©´ë˜ë¯€ë¡œ, existë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ë” ì ì ˆí•˜ë‹¤.


---

<br>
<br>
<br>

## mongoose middleware (= hook)

> hashtagsì—ì„œ í•´ì£¼ëŠ” ê³¼ì •ë“¤ì„ ì¤‘ê°„ì—ì„œ ë”°ë¡œ ì²˜ë¦¬í•˜ê³ , ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•´ì„œ, í›¨ì”¬ ì§ê´€ì ìœ¼ë¡œ ì½”ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

[middleware -https://mongoosejs.com/docs/middleware.html](https://mongoosejs.com/docs/middleware.html)


![d](/Image/Express/m1.PNG)
![d](/Image/Express/m3.PNG)
> thisëŠ” document!!
![d](/Image/Express/m2.PNG)
> saveë¥¼ ëŒ€ê¸°í• ë•Œ, í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

![d](/Image/Express/m4.PNG)
![d](/Image/Express/m5.PNG)

> saveê°€ ë˜ê¸° ì§ì „ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì—, ì†ì„±ë“¤ì„ ë§ˆìŒëŒ€ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤.!


>> ğŸ”¥ ì´ middlewareë¥¼ ì´ìš©í•´ì„œ hashtagsë¥¼ ìˆ˜ì •í•´ ë³´ì!!

![d](/Image/Express/m8.PNG)

![d](/Image/Express/m6.PNG)

ğŸ™Œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê¸°ì „ì— ê°€ë¡œì±„ì„œ, ë¬¸ì„œë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤!!


## ì¼ë°˜ js í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ, ë¶„ë¦¬í•˜ê¸°.
> ì´ê²ƒë„ ì¶©ë¶„íˆ ê´œì°®ì€ ë°©ë²•.

![d](/Image/Express/m9.PNG)

![d](/Image/Express/m10.PNG)

![d](/Image/Express/m11.PNG)

![d](/Image/Express/m12.PNG)


## Staticìœ¼ë¡œ ì •ë¦¬.
> modelì— ì ‘ê·¼í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì´ìš©í•˜ê¸°.

> ë§ˆì¹˜, findByIdAndUpdate, findById, existì²˜ëŸ¼, modelì— ì ‘ê·¼í•´ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ì—­í• ì´ staticì´ë‹¤.

> ë”°ë¡œ export , importí•  í•„ìš”ë„ ì—†ë”” -> modelê°ì²´ë§Œ importí•´ì˜¤ë©´ ë”¸ë ¤ì˜¤ëŠ” í•¨ìˆ˜!


![d](/Image/Express/m13.PNG)
![d](/Image/Express/m14.PNG)



#### cf. í•´ì‹œíƒœê·¸ templateì— ë³´ì´ê²Œ

![d](/Image/Express/m15.PNG)

---

<br>
<br>
<br>


## Delete Video






