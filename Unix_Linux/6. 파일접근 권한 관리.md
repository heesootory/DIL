# 6. 파일 접근권한 관리

## 파일의 속성

### 다중 사용자 시스템의 특징
* 여러 사람이 하나의 시스템 사용.
* 다른 사람이 내 파일을 읽거나 수정, 삭제 할 수 없도록 보안 필요
* 다른 사용자의 무단 접근으로부터 자신의 파일을 보호하는 기능으로 파일에 접근 권한을 부여하여 권한 만큼만 파일을 사용.

### 파일의 속성 -> i-node정보
* 파일의 종류
* 파일 접근 권한
* 하드 링크 개수
* 파일 소유자의 사용자 이름
* 파일이 속한 그룹 이름
* 파일 크기
* 파일의 마지막 수정 일시

#### ls -l로 확인할 수 있는 파일 속성
1. -/d : 파일 종류(- : 일반파일, d : 디렉토리)
2. rw-r--r-- : 파일을 읽고, 스고, 실행할 수 있는 접근 권한 표시
3. 1 : 하드 링크 수
4. user 1 : 파일 소유자의 로그인 ID.
5. staff : 파일 소유자의 그룹 이름.
6. 193 : 파일의 크기(바이트 단위)
7. Jun 19 20:24 : 파일이 마지막으로 수정된 일시
8. homework.dat : 파일명


## 파일의 접근 권한

| 권한 | 파일 | 디렉토리 |
|-|-|-|
| 읽기(r) | 파일을 읽거나 복사 가능 | ls명령으로 디렉토리 목록을 볼 수 있다. (ls명령은 실행 권한이 있어야 가능) |
| 쓰기(w) | 파일을 수정, 이동, 삭제할 수 있다. (디렉토리에 쓰기 권한이 있어야 가능)| 파일을 생성하거나 삭제 가능.|
| 실행(x) | 파일을 실행할 수 있다.(쉘 스크립트나 실행파일의 경우) | cd명령의 사용이 가능.(파일 디렉토리를 이동하거나 복사 가능.) | 

### 접근 권한 표기 방법
| rw- | r-- | r--|
|-|-|-|
|소유자|그룹사용자|기타 사용자|

### 파일 접근 권한 변경
```bash
$ chmod [옵션] 모드 파일명
```
* 옵션 
    - -R : 하위 디렉토리까지 모두 변경

#### 기호 모드를 이용한 권한 변경
```bash
$ chmod [사용자 카테고리] [연산자] [권한] 파일명
```

* 기호모드
    - 사용자 카테고리
        - u : 소유자
        - g : 그룹
        - o : 기타 사용자
        - a : 모든 사용자(u + g + o)
    - 연산자 기호
        - \+ : 허가권 부여
        - \- : 허가권 제거
        - \= : 특정 사용자에게 허가권 지정.
    - 권한 기호
        - r : 읽기 허가
        - w : 쓰기 허가
        - x : 실행 허가

* 예시
```bash
$ chmod u-w homework.sh
$ chmod g+wx homework.sh
$ chmod o+x homework.sh
$ chmod go-x homework.sh
$ chmod a+x homework.sh
$ chmod u+w, g-w homework.sh
$ chmod go-wx homework.sh
$ chmod a=rwx homework.sh

```


#### 숫자 모드를 이용한 권한 변경

* 숫자 모드
    - 숫자를 이용하여 접근 권한 표현
    - 모든 카테고리의 접근 권한을 동시에 조정 할 때 기호모드보다 편리.
    - 각 카테고리 별로 접근 권한을 하나의 8진수로 표현
    - 3개 8진수를 사용하여 전체 접근 권한 표기

* 표기 방법

|   | 소유자 | 그룹 | 기타사용자 |
|-|-|-|-|
| 1.사용권한 | rwx | r-x | r-x|
| 2.2진수로 대체 | 111 | 101 | 101 |
| 3.8진수로 변환 | 7 | 5 | 5 |


* 예시

```bash
$ chmod 444 homework.dat -> r--r--r--
$ chmod 474 homework.dat -> r--rwxr--
$ chmod 475 homework.dat -> r--rwxr-w
$ chmod 464 homework.dat -> r--rw-r--
$ chmod 575 homework.dat -> r-xrwxr-x
$ chmod 755 homework.dat -> rwxr-xr-x
$ chmod 700 homework.dat -> rwx------
```


#### 기본 접근 권한

| 파일 | 기본접근 허가권 |
|-|-|
|실행할 수 없는 일반 파일(문서 편집기로 생성한 파일) | 666|
|실행할 수 있는 일반 파일 | 777|
|디렉토리 | 777|



#### 기본 접근 권한의 설정

```bash
$ umask [마스크값]
```
* 마스크값
    - 파일이나 디렉토리 생성시 부여하지 않을 권한 지정.
    - 이 값을 지정하면 지정한 마스크를 이용하여 기본 접근 권한 지정.
    - 지정하지 않으면 현재 설정된 마스크값 출력.

* 마스크
>  "가리다" = 허용하지 않을 값을 지정.

* 기본 사용 권한 XOR마스크 (XOR : 두 값이 같으면 0, 다르면 1)

|    | 일반 파일 | 디렉토리 |
|-|-|-|
|1.최대권한 | rw-rw-rw- | rwxrwxrwx |
|2.2진수 표현 | 110110110(666) | 111111111(777) |
|3.마스크값(022) | 000010010(022) | 000010010(022) |
|4.XOR결과 | 110100100(644) | 111101101(755) | 

> 간단하게 생각하면, 결국 모두 숫자모드로 봤을때, "최대권한(2진수표현) - 마스크값 = 권한 결과" 이다.












